============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-8.4.2, pluggy-1.6.0 -- /home/danvm/.conda/envs/release/bin/python3.12
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /home/danvm/ao
configfile: pyproject.toml
plugins: hypothesis-6.148.6, anyio-4.12.0
collecting ... TMA benchmarks will be running without grid constant TMA descriptor.
NOTE: Using slow Hadamard transform for SpinQuant. For better performance on GPU, install `fast_hadamard_transform`: `pip install git+https://github.com/Dao-AILab/fast-hadamard-transform.git`
collected 10930 items / 9 skipped

test/core/test_config.py::test_reconstructable_dict_file_round_trip[config0] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config1] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config2] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config3] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config4] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config5] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config6] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config7] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config8] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config9] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config10] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config11] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config12] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config13] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config14] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config15] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config16] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config17] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config18] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config19] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config20] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config21] PASSED
test/core/test_config.py::test_reconstructable_dict_file_round_trip[config22] PASSED
test/core/test_config.py::test_granularity_serialization[granularity0] TMA benchmarks will be running without grid constant TMA descriptor.
PASSED
test/core/test_config.py::test_granularity_serialization[granularity1] TMA benchmarks will be running without grid constant TMA descriptor.
PASSED
test/core/test_config.py::test_granularity_serialization[granularity2] TMA benchmarks will be running without grid constant TMA descriptor.
PASSED
test/core/test_config.py::test_disallowed_modules PASSED
test/core/test_config.py::test_version_mismatch PASSED
test/core/test_config.py::test_default_version PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant0 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant1 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant2 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant3 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant4 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_copy__mismatch_metadata_apply_quant5 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_print_quantized_module FAILED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_register_new_dispatch PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_tensor_core_layout_transpose PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant0 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant1 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant2 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant3 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant4 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_test_copy__apply_apply_quant5 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_affine_quantized_intx_static PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_device_apply_quant0 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_device_apply_quant1 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_device_apply_quant2 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_device_apply_quant3 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_to_device_apply_quant4 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantized::test_weights_only PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_alias_device_cpu_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_alias_device_cuda_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_flatten_unflatten_device_cpu_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_flatten_unflatten_device_cuda_bfloat16 FAILED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_matmul_cuda_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_mm_int4wo_cuda_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_slice_and_copy_int4wo_cuda_bfloat16 PASSED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_slice_gemlite_cuda_bfloat16 SKIPPED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_slice_gemlite_cuda_float16 SKIPPED
test/dtypes/test_affine_quantized.py::TestAffineQuantizedBasic::test_slice_int4wo_cuda_bfloat16 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_choose_scale_float8_bounds_float8_e4m3fn_bfloat16 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_choose_scale_float8_bounds_float8_e4m3fn_float32 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_choose_scale_float8_bounds_float8_e5m2_bfloat16 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_choose_scale_float8_bounds_float8_e5m2_float32 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_bfloat16_block_size0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_bfloat16_block_size1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_bfloat16_block_size2 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_bfloat16_block_size3 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_float32_block_size0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_float32_block_size1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_float32_block_size2 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e4m3fn_float32_block_size3 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_bfloat16_block_size0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_bfloat16_block_size1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_bfloat16_block_size2 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_bfloat16_block_size3 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_float32_block_size0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_float32_block_size1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_float32_block_size2 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_float8_e5m2_float32_block_size3 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_dequantize_affine_float8_scale_broadcasting PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_expected_kernels_on_gpu_granularity0_float8_config_version_1 frames [('total', 1), ('ok', 1)]
stats [('calls_captured', 1), ('unique_graphs', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 34), ('benchmarking.InductorBenchmarker.benchmark_gpu', 34), ('coordesc_tuning_bench', 34), ('triton_bundler_save_kernel', 24), ('async_compile_cache_miss', 3), ('pattern_matcher_count', 1), ('pattern_matcher_nodes', 1), ('fxgraph_cache_miss', 1), ('extern_calls', 1), ('triton_bundler_save_static_autotuner', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_512_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_expected_kernels_on_gpu_granularity0_float8_config_version_2 frames [('total', 1), ('ok', 1)]
stats [('calls_captured', 1), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 34), ('benchmarking.InductorBenchmarker.benchmark_gpu', 34), ('coordesc_tuning_bench', 34), ('triton_bundler_save_kernel', 24), ('async_compile_cache_miss', 6), ('async_compile_cache_hit', 3), ('pattern_matcher_count', 1), ('pattern_matcher_nodes', 1), ('fxgraph_cache_miss', 1), ('extern_calls', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_512_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_expected_kernels_on_gpu_granularity1_float8_config_version_1 frames [('total', 1), ('ok', 1)]
stats [('calls_captured', 1), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 8), ('benchmarking.InductorBenchmarker.benchmark', 5), ('benchmarking.InductorBenchmarker.benchmark_gpu', 5), ('coordesc_tuning_bench', 5), ('pattern_matcher_count', 2), ('pattern_matcher_nodes', 2), ('async_compile_cache_miss', 2), ('fxgraph_cache_miss', 1), ('extern_calls', 1), ('async_compile_cache_hit', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_512_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_expected_kernels_on_gpu_granularity1_float8_config_version_2 frames [('total', 1), ('ok', 1)]
stats [('calls_captured', 1), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 8), ('benchmarking.InductorBenchmarker.benchmark', 6), ('benchmarking.InductorBenchmarker.benchmark_gpu', 6), ('coordesc_tuning_bench', 6), ('pattern_matcher_count', 2), ('pattern_matcher_nodes', 2), ('async_compile_cache_miss', 2), ('fxgraph_cache_miss', 1), ('extern_calls', 1), ('async_compile_cache_hit', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_512_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_basic_granularity0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_basic_granularity1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_edge_cases PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_functional_correctness_granularity0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_functional_correctness_granularity1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_per_row PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_float8_tensor_slicing_per_tensor PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 79), ('benchmarking.InductorBenchmarker.benchmark_gpu', 79), ('coordesc_tuning_bench', 79), ('triton_bundler_save_kernel', 48), ('async_compile_cache_miss', 12), ('async_compile_cache_hit', 6), ('pattern_matcher_count', 2), ('pattern_matcher_nodes', 2), ('extern_calls', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_256_128', 1), ('aten._scaled_mm.default_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 64), ('benchmarking.InductorBenchmarker.benchmark', 61), ('benchmarking.InductorBenchmarker.benchmark_gpu', 61), ('coordesc_tuning_bench', 57), ('async_compile_cache_miss', 12), ('pattern_matcher_count', 6), ('pattern_matcher_nodes', 6), ('async_compile_cache_hit', 6), ('extern_calls', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_4096_64_256', 1), ('aten._scaled_mm.default_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_True_granularity1_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 32), ('benchmarking.InductorBenchmarker.benchmark', 24), ('benchmarking.InductorBenchmarker.benchmark_gpu', 24), ('coordesc_tuning_bench', 21), ('pattern_matcher_count', 4), ('pattern_matcher_nodes', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_256_128', 1), ('aten._scaled_mm.default_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_dynamic_compile_True_granularity1_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 32), ('benchmarking.InductorBenchmarker.benchmark', 18), ('benchmarking.InductorBenchmarker.benchmark_gpu', 18), ('coordesc_tuning_bench', 15), ('pattern_matcher_count', 6), ('pattern_matcher_nodes', 6), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_4096_64_256', 1), ('aten._scaled_mm.default_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 24), ('benchmarking.InductorBenchmarker.benchmark_gpu', 24), ('coordesc_tuning_bench', 24), ('triton_bundler_save_kernel', 16), ('pattern_matcher_count', 4), ('pattern_matcher_nodes', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_256_128', 1), ('aten._scaled_mm.default_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 32), ('benchmarking.InductorBenchmarker.benchmark', 19), ('benchmarking.InductorBenchmarker.benchmark_gpu', 19), ('coordesc_tuning_bench', 15), ('pattern_matcher_count', 6), ('pattern_matcher_nodes', 6), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_4096_64_256', 1), ('aten._scaled_mm.default_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_True_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_static_compile_True_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 56), ('benchmarking.InductorBenchmarker.benchmark', 45), ('benchmarking.InductorBenchmarker.benchmark_gpu', 45), ('coordesc_tuning_bench', 39), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_128_256_128', 1), ('aten.mm_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 48), ('benchmarking.InductorBenchmarker.benchmark', 39), ('benchmarking.InductorBenchmarker.benchmark_gpu', 39), ('coordesc_tuning_bench', 34), ('pattern_matcher_nodes', 5), ('pattern_matcher_count', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('removed_pointless_view_pair', 1), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_4096_64_256', 1), ('aten.mm_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_True_granularity1_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 57), ('benchmarking.InductorBenchmarker.benchmark_gpu', 57), ('triton_bundler_save_kernel', 56), ('coordesc_tuning_bench', 51), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_128_256_128', 1), ('aten.mm_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_bfloat16_mode_weight-only_compile_True_granularity1_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 48), ('benchmarking.InductorBenchmarker.benchmark', 32), ('benchmarking.InductorBenchmarker.benchmark_gpu', 32), ('coordesc_tuning_bench', 27), ('pattern_matcher_nodes', 5), ('pattern_matcher_count', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('removed_pointless_view_pair', 1), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_4096_64_256', 1), ('aten.mm_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 69), ('benchmarking.InductorBenchmarker.benchmark_gpu', 69), ('coordesc_tuning_bench', 69), ('triton_bundler_save_kernel', 48), ('async_compile_cache_miss', 12), ('async_compile_cache_hit', 6), ('pattern_matcher_count', 2), ('pattern_matcher_nodes', 2), ('extern_calls', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_256_128', 1), ('aten._scaled_mm.default_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 64), ('benchmarking.InductorBenchmarker.benchmark', 64), ('benchmarking.InductorBenchmarker.benchmark_gpu', 64), ('coordesc_tuning_bench', 60), ('async_compile_cache_miss', 12), ('pattern_matcher_count', 6), ('pattern_matcher_nodes', 6), ('async_compile_cache_hit', 6), ('extern_calls', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_4096_64_256', 1), ('aten._scaled_mm.default_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_True_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_dynamic_compile_True_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 18), ('benchmarking.InductorBenchmarker.benchmark_gpu', 18), ('coordesc_tuning_bench', 18), ('triton_bundler_save_kernel', 16), ('pattern_matcher_count', 4), ('pattern_matcher_nodes', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_128_256_128', 1), ('aten._scaled_mm.default_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 32), ('benchmarking.InductorBenchmarker.benchmark', 25), ('benchmarking.InductorBenchmarker.benchmark_gpu', 25), ('coordesc_tuning_bench', 21), ('pattern_matcher_count', 6), ('pattern_matcher_nodes', 6), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten._scaled_mm.default_4096_64_256', 1), ('aten._scaled_mm.default_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_True_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_static_compile_True_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_False_granularity0_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_False_granularity0_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_False_granularity1_sizes0 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_False_granularity1_sizes1 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_True_granularity0_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 20), ('benchmarking.InductorBenchmarker.benchmark_gpu', 20), ('coordesc_tuning_bench', 20), ('triton_bundler_save_kernel', 16), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_128_256_128', 1), ('aten.mm_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_True_granularity0_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 48), ('benchmarking.InductorBenchmarker.benchmark', 41), ('benchmarking.InductorBenchmarker.benchmark_gpu', 41), ('coordesc_tuning_bench', 36), ('pattern_matcher_nodes', 5), ('pattern_matcher_count', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('removed_pointless_view_pair', 1), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_4096_64_256', 1), ('aten.mm_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_True_granularity1_sizes0 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('benchmarking.InductorBenchmarker.benchmark', 26), ('benchmarking.InductorBenchmarker.benchmark_gpu', 26), ('coordesc_tuning_bench', 26), ('triton_bundler_save_kernel', 16), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_128_256_128', 1), ('aten.mm_128_128_256', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_linear_variants_float32_mode_weight-only_compile_True_granularity1_sizes1 stats [('calls_captured', 2), ('unique_graphs', 1)]
aot_autograd [('total', 1), ('autograd_cache_miss', 1), ('autograd_cache_saved', 1), ('ok', 1)]
inductor [('triton_bundler_save_kernel', 48), ('benchmarking.InductorBenchmarker.benchmark', 39), ('benchmarking.InductorBenchmarker.benchmark_gpu', 39), ('coordesc_tuning_bench', 34), ('pattern_matcher_nodes', 5), ('pattern_matcher_count', 4), ('async_compile_cache_miss', 4), ('extern_calls', 2), ('async_compile_cache_hit', 2), ('removed_pointless_view_pair', 1), ('fxgraph_cache_miss', 1), ('triton_bundler_save_static_autotuner', 1)]
graph_break []
aten_mm_info [('aten.mm_4096_64_256', 1), ('aten.mm_4096_256_64', 1)]
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_fp8_weight_dimension_warning ToyLinearModel(
  (linear1): Linear(in_features=10, out_features=25, bias=False, weight=Tensor: <class 'torch.nn.parameter.Parameter'>)
  (linear2): Linear(in_features=25, out_features=10, bias=False, weight=Tensor: <class 'torch.nn.parameter.Parameter'>)
)
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_invalid_granularity PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mismatched_granularity PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape0_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape0_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape1_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape1_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape2_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape2_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape3_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape3_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape4_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_1024_out_features_512_leading_shape4_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape0_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape0_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape1_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape1_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape2_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape2_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape3_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape3_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape4_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_256_out_features_768_leading_shape4_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape0_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape0_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape1_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape1_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape2_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape2_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape3_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape3_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape4_bias_False PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_mm_float8dq_per_row_in_features_512_out_features_1024_leading_shape4_bias_True PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_per_row_with_float32 PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_preprocess_scale_3d_reshape PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_quantize_dequantize_fp8_inductor_float8_e4m3fn_bfloat16 frames [('total', 2), ('ok', 2)]
stats [('calls_captured', 2), ('unique_graphs', 2)]
aot_autograd [('total', 2), ('autograd_cache_miss', 2), ('autograd_cache_saved', 2), ('ok', 2)]
inductor [('extern_calls', 4), ('fxgraph_cache_miss', 2)]
graph_break []
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_quantize_dequantize_fp8_inductor_float8_e4m3fn_float32 frames [('total', 2), ('ok', 2)]
stats [('calls_captured', 2), ('unique_graphs', 2)]
aot_autograd [('total', 2), ('autograd_cache_miss', 2), ('autograd_cache_saved', 2), ('ok', 2)]
inductor [('extern_calls', 4), ('fxgraph_cache_miss', 2)]
graph_break []
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_quantize_dequantize_fp8_inductor_float8_e5m2_bfloat16 frames [('total', 2), ('ok', 2)]
stats [('calls_captured', 2), ('unique_graphs', 2)]
aot_autograd [('total', 2), ('autograd_cache_miss', 2), ('autograd_cache_saved', 2), ('ok', 2)]
inductor [('extern_calls', 4), ('fxgraph_cache_miss', 2)]
graph_break []
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_quantize_dequantize_fp8_inductor_float8_e5m2_float32 frames [('total', 2), ('ok', 2)]
stats [('calls_captured', 2), ('unique_graphs', 2)]
aot_autograd [('total', 2), ('autograd_cache_miss', 2), ('autograd_cache_saved', 2), ('ok', 2)]
inductor [('extern_calls', 4), ('fxgraph_cache_miss', 2)]
graph_break []
PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_serialization_mode_dynamic PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_serialization_mode_static PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_serialization_mode_weight-only PASSED
test/dtypes/test_affine_quantized_float.py::TestAffineQuantizedFloat8Compile::test_unsupported_granularity PASSED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestInt8woAffineQuantizedTensorParallel::test_tp_bfloat16 I1204 14:49:48.793000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 3994849
I1204 14:49:48.795000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 3994853
I1204 14:49:48.797000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 3994857
I1204 14:49:48.799000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 3994860
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
NCCL version 2.27.5+cuda12.9
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
PASSED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestInt8woAffineQuantizedTensorParallel::test_tp_float16 I1204 14:50:02.048000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4001302
I1204 14:50:02.050000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4001308
I1204 14:50:02.058000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4001314
I1204 14:50:02.060000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4001329
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
NCCL version 2.27.5+cuda12.9
PASSED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestInt8woAffineQuantizedTensorParallel::test_tp_float32 I1204 14:50:18.788000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4019773
I1204 14:50:18.790000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4019776
I1204 14:50:18.792000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4019780
I1204 14:50:18.795000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4019786
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1352: UserWarning: Config Deprecation: version 1 of Int8WeightOnlyConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
NCCL version 2.27.5+cuda12.9
PASSED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestInt4woAffineQuantizedTensorParallel::test_tp_bfloat16 SKIPPED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestGemliteLayoutTensorParallel::test_tp_gemlite_float16 SKIPPED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestInt8dqAffineQuantizedTensorParallel::test_tp_bfloat16 I1204 14:50:35.226000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4034897
I1204 14:50:35.228000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4034904
I1204 14:50:35.230000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4034908
I1204 14:50:35.232000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4034913
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1566: UserWarning: Config Deprecation: version 1 of Int8DynamicActivationInt8WeightConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1566: UserWarning: Config Deprecation: version 1 of Int8DynamicActivationInt8WeightConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1566: UserWarning: Config Deprecation: version 1 of Int8DynamicActivationInt8WeightConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quant_api.py:1566: UserWarning: Config Deprecation: version 1 of Int8DynamicActivationInt8WeightConfig is deprecated and will no longer be supported in a future release, please use version 2, see https://github.com/pytorch/ao/issues/2752 for more details
  warnings.warn(
NCCL version 2.27.5+cuda12.9
PASSED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8woAffineQuantizedTensorParallel::test_tp_bfloat16 I1204 14:50:53.577000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4050466
I1204 14:50:53.579000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4050467
I1204 14:50:53.581000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4050469
I1204 14:50:53.583000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4050471
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:50:58.642000 4050467 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:50:59.271000 4050471 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:50:59.272000 4050469 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:50:59.277000 4050466 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
Process 1 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8woAffineQuantizedTensorParallel::test_tp_float16 I1204 14:50:59.619000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4052343
I1204 14:50:59.621000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4052344
I1204 14:50:59.625000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4052346
I1204 14:50:59.627000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4052348
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:05.179000 4052343 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:05.677000 4052348 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:05.905000 4052344 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
Process 0 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8woAffineQuantizedTensorParallel::test_tp_float32 I1204 14:51:05.970000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4055063
I1204 14:51:05.972000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4055068
I1204 14:51:05.974000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4055071
I1204 14:51:05.976000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4055074
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:12.993000 4055068 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:13.012000 4055071 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:13.015000 4055074 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 210, in test_tp
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8woAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:13.019000 4055063 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
Process 1 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8dqTensorAffineQuantizedTensorParallel::test_tp_bfloat16 I1204 14:51:13.816000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4061064
I1204 14:51:13.818000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4061080
I1204 14:51:13.820000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4061085
I1204 14:51:13.821000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4061089
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:17.737000 4061080 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:18.209000 4061089 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:18.232000 4061085 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:18.235000 4061064 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
Process 1 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8dqTensorAffineQuantizedTensorParallel::test_tp_float16 I1204 14:51:18.662000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4064730
I1204 14:51:18.664000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4064731
I1204 14:51:18.666000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4064733
I1204 14:51:18.668000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4064735
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:25.499000 4064730 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:25.504000 4064731 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:25.509000 4064735 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float16
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:25.521000 4064733 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
Process 0 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8dqTensorAffineQuantizedTensorParallel::test_tp_float32 I1204 14:51:26.309000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4070526
I1204 14:51:26.311000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4070527
I1204 14:51:26.313000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4070529
I1204 14:51:26.315000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4070531
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:30.182000 4070526 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:30.186000 4070531 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:30.839000 4070529 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 223, in test_tp
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqTensorAffineQuantizedTensorParallel.test_tp_float32
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:30.883000 4070527 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
Process 0 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_affine_quantized_tensor_parallel.py::TestFloat8dqRowAffineQuantizedTensorParallel::test_tp_bfloat16 I1204 14:51:31.250000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 0 with pid 4074998
I1204 14:51:31.255000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 1 with pid 4074999
I1204 14:51:31.258000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 2 with pid 4075002
I1204 14:51:31.259000 3932578 site-packages/torch/testing/_internal/common_distributed.py:849] Started process 3 with pid 4075003
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
TMA benchmarks will be running without grid constant TMA descriptor.
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 236, in test_tp
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqRowAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:37.349000 4075003 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 3 with exit code: 10
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 236, in test_tp
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqRowAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:37.436000 4074998 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 0 with exit code: 10
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 236, in test_tp
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqRowAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:37.475000 4075002 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 2 with exit code: 10
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] Caught exception: 
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] Traceback (most recent call last):
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 925, in run_test
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     getattr(self, test_name)()
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_distributed.py", line 772, in wrapper
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     fn()
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 3329, in wrapper
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     method(*args, **kwargs)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/common_utils.py", line 586, in instantiated_test
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     test(self, **param_kwargs)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 533, in wrapper
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     raise e
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 530, in wrapper
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     func(self, *args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 236, in test_tp
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return self._test_tp(dtype)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 122, in _test_tp
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     up_dist = self.colwise_shard(up_quant, mesh)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/ao/test/dtypes/test_affine_quantized_tensor_parallel.py", line 61, in colwise_shard
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     dtensor = DTensor.from_local(local_shard, mesh, [Shard(0)])
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 441, in from_local
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return _FromTorchTensor.apply(  # pyre-ignore[16]: autograd func
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/autograd/function.py", line 583, in apply
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return super().apply(*args, **kwargs)  # type: ignore[misc]
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torch/distributed/tensor/_api.py", line 192, in forward
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     input.view_as(input),
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     ^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 636, in _dispatch__torch_function__
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return func(*args, **kwargs)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 652, in _dispatch__torch_dispatch__
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return cls._ATEN_OP_TABLE[cls][func](func, types, args, kwargs)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/utils.py", line 417, in wrapper
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     return _func(f, types, args, kwargs)
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]   File "/home/danvm/.conda/envs/release/lib/python3.12/site-packages/torchao/quantization/quantize_/workflows/float8/float8_tensor.py", line 866, in _
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     scale_shape.append(qdata.shape[i] // self.block_size[i])
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]                        ~~~~~~~~~~~^^^
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] IndexError: tuple index out of range
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] To execute this test, run the following from the base repo dir:
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]     python test/dtypes/test_affine_quantized_tensor_parallel.py TestFloat8dqRowAffineQuantizedTensorParallel.test_tp_bfloat16
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] 
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935] This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0
E1204 14:51:37.530000 4074999 site-packages/torch/testing/_internal/common_distributed.py:935]  exiting process 1 with exit code: 10
Process 0 terminated with exit code 10, terminating remaining processes.
FAILED
test/dtypes/test_bitpacking.py::test_CPU[0-1] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-2] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-3] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-4] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-5] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-6] PASSED
test/dtypes/test_bitpacking.py::test_CPU[0-7] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-1] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-2] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-3] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-4] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-5] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-6] PASSED
test/dtypes/test_bitpacking.py::test_CPU[-1-7] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-1] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-2] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-3] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-4] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-5] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-6] PASSED
test/dtypes/test_bitpacking.py::test_CPU[1-7] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-1] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-2] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-3] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-4] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-5] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-6] PASSED
test/dtypes/test_bitpacking.py::test_GPU[0-7] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-1] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-2] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-3] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-4] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-5] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-6] PASSED
test/dtypes/test_bitpacking.py::test_GPU[-1-7] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-1] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-2] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-3] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-4] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-5] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-6] PASSED
test/dtypes/test_bitpacking.py::test_GPU[1-7] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-1] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-2] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-3] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-4] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-5] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-6] PASSED
test/dtypes/test_bitpacking.py::test_compile[0-7] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-1] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-2] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-3] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-4] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-5] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-6] PASSED
test/dtypes/test_bitpacking.py::test_compile[-1-7] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-1] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-2] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-3] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-4] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-5] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-6] PASSED
test/dtypes/test_bitpacking.py::test_compile[1-7] PASSED
test/dtypes/test_bitpacking.py::test_pack_example tensor([  0, 105, 151,  37], device='cuda:0', dtype=torch.uint8) tensor([ 39, 146], device='cuda:0', dtype=torch.uint8)
PASSED
test/dtypes/test_bitpacking.py::test_pack_example_CPU tensor([  0, 105, 151,  37], dtype=torch.uint8) tensor([ 39, 146], dtype=torch.uint8)
PASSED
test/dtypes/test_floatx.py::TestFloatxTensorCoreAQTTensorImpl::test_fpx_weight_only_ebits_2_mbits_2_bias_False_bfloat16 CUDA error (/__w/ao/ao/pytorch/ao/torchao/csrc/cuda/fp6_llm/fp6_linear.cu:84): no kernel image is available for execution on the device

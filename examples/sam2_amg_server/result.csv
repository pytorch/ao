p95,miou,export-model,second,argmax,bytes_MiB,gpu-preproc,third,total_img_s,torchvision_version,batch_size,first,experiment_name,mean,max,fourth,batch-size,total_ms_per_img,p999,furious,torch_version,fail_count,likely_failed_stderr,environ,num-images,allow-recompiles,fifth,median,points-per-batch,fast,total_time,run_script_time,baseline,p99,meta-folder,task,bytes,load-exported-model,percentage
1340ms,,,978ms,833,4350.0,,941ms,1.0799033334527448img/s,0.22.0.dev20250201+cu124,1.0,1792ms,baseline_amg,920ms,2373ms,878ms,,926.0088093280792ms,2358ms,,2.7.0.dev20250201+cu124,,,None,,,715ms,868ms,64,,926.0088093280792s,930.1652717590332,None,2052ms,,amg,4561654784.0,,4.0
824ms,1.0,,683ms,0,4010.0,,680ms,1.3745557869688423img/s,0.22.0.dev20250201+cu124,1.0,1190ms,amg_ao,721ms,1190ms,655ms,,727.5077588558197ms,951ms,,2.7.0.dev20250201+cu124,0.0,,None,,,656ms,706ms,64,,727.5077588558197s,731.7412638664246,,874ms,,amg,4205527040.0,,4.0
737ms,0.9999994533658028,,641ms,109,33774.0,,718ms,1.5758385248283322img/s,0.22.0.dev20250201+cu124,1.0,1276ms,amg_ao_ppb_1024_basic,629ms,1958ms,585ms,1,634.5827851295471ms,1277ms,,2.7.0.dev20250201+cu124,0.0,,None,,,578ms,612ms,1024,,634.5827851295471s,638.9460968971252,,799ms,,amg,35415179776.0,,34.0
546ms,,,3159ms,0,29349.0,,411ms,1.3157337560201974img/s,0.22.0.dev20250201+cu124,1.0,312842ms,amg_ao_ppb_1024_fast_cold,751ms,312842ms,383ms,1,760.0321838855743ms,3469ms,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_inductor_cache_dir'},,,379ms,417ms,1024,None,760.0321838855743s,768.5509376525879,,613ms,,amg,30775568896.0,,30.0
547ms,0.9937493040073667,,1003ms,0,29349.0,,506ms,2.216069407982153img/s,0.22.0.dev20250201+cu124,1.0,8635ms,amg_ao_ppb_1024_fast,445ms,8635ms,483ms,1,451.2494041919708ms,1405ms,,2.7.0.dev20250201+cu124,189.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_inductor_cache_dir'},,,485ms,420ms,1024,None,451.2494041919708s,456.6959626674652,,627ms,,amg,30775568896.0,,30.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,,,29645.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,amg_ao_ppb_1024_save_export,,,,1,,,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_inductor_cache_dir'},0,,,,1024,,316.4186329841614s,325.6022822856903,,,,amg,31085598208.0,,30.0
712ms,0.9937248888207071,,606ms,10,47526.0,,643ms,1.6170744759812854img/s,0.22.0.dev20250201+cu124,1.0,953ms,amg_ao_ppb_1024_load_export_cold,612ms,1579ms,606ms,1,618.4007074832916ms,1556ms,,2.7.0.dev20250201+cu124,190.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_inductor_cache_dir'},,,609ms,609ms,1024,,618.4007074832916s,622.940381526947,,770ms,,amg,49835272192.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,48.0
703ms,0.9937248888207071,,542ms,10,47526.0,,529ms,1.6781757808220514img/s,0.22.0.dev20250201+cu124,1.0,1066ms,amg_ao_ppb_1024_load_export,589ms,1693ms,519ms,1,595.8851339817047ms,1449ms,,2.7.0.dev20250201+cu124,190.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_inductor_cache_dir'},,,498ms,595ms,1024,,595.8851339817047s,599.7862982749939,,757ms,,amg,49835272192.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,48.0
667ms,0.9938783051409558,,533ms,10,47550.0,None,527ms,1.7373975964302135img/s,0.22.0.dev20250201+cu124,1.0,974ms,amg_ao_ppb_1024_load_export_gpu_preproc,569ms,1642ms,569ms,1,575.5734910964966ms,1524ms,,2.7.0.dev20250201+cu124,184.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_inductor_cache_dir'},,,548ms,562ms,1024,,575.5734910964966s,579.972053527832,,723ms,,amg,49860438016.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,48.0
,,,,,,,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_cold,,,,1,,,,2.7.0.dev20250201+cu124,,"W0201 21:05:51.283000 2453999 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_inductor_cache_dir'},,,,,1024,None,,8.374484539031982,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,
,,,,,,,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export,,,,1,,,,2.7.0.dev20250201+cu124,,"W0201 21:05:59.947000 2454821 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_inductor_cache_dir'},,,,,1024,None,,8.955483675003052,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,
,,,,,,None,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_gpu_preproc,,,,1,,,,2.7.0.dev20250201+cu124,,"W0201 21:06:08.712000 2455537 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_inductor_cache_dir'},,,,,1024,None,,8.615297555923462,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast,
271ms,0.9776658477900515,,3162ms,0,28335.0,,197ms,1.0480475681278645img/s,0.22.0.dev20250201+cu124,1.0,759170ms,amg_ao_ppb_1024_fast_furious_cold,945ms,759170ms,160ms,1,954.1551647186279ms,3918ms,None,2.7.0.dev20250201+cu124,309.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_furious_inductor_cache_dir'},,,151ms,171ms,1024,None,954.1551647186279s,967.3410406112671,,323ms,,amg,29712143872.0,,29.0
273ms,0.9776658477900515,,1044ms,0,28335.0,,195ms,4.884662659396177img/s,0.22.0.dev20250201+cu124,1.0,9084ms,amg_ao_ppb_1024_fast_furious,196ms,9084ms,164ms,1,204.7224280834198ms,1052ms,None,2.7.0.dev20250201+cu124,309.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_furious_inductor_cache_dir'},,,141ms,174ms,1024,None,204.7224280834198s,210.37224745750427,,326ms,,amg,29712143872.0,,29.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,,,14882.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,amg_ao_ppb_1024_save_export_furious,,,,1,,,None,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_furious_inductor_cache_dir'},0,,,,1024,,499.48295998573303s,511.67096495628357,,,,amg,15605533184.0,,15.0
350ms,0.9764917599518406,,291ms,109,27949.0,,277ms,3.7168398164749727img/s,0.22.0.dev20250201+cu124,1.0,1019ms,amg_ao_ppb_1024_load_export_furious_cold,263ms,1387ms,220ms,1,269.0457618236542ms,1019ms,None,2.7.0.dev20250201+cu124,307.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_furious_inductor_cache_dir'},,,221ms,251ms,1024,,269.0457618236542s,273.38352060317993,,407ms,,amg,29307608064.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,28.0
351ms,0.9764917599518406,,255ms,109,27949.0,,249ms,3.7423127969253986img/s,0.22.0.dev20250201+cu124,1.0,922ms,amg_ao_ppb_1024_load_export_furious,261ms,1385ms,258ms,1,267.2144351005554ms,923ms,None,2.7.0.dev20250201+cu124,307.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_furious_inductor_cache_dir'},,,255ms,251ms,1024,,267.2144351005554s,271.66322326660156,,408ms,,amg,29307608064.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,28.0
324ms,0.9735295268444653,,250ms,109,27972.0,None,250ms,4.0177111319890075img/s,0.22.0.dev20250201+cu124,1.0,885ms,amg_ao_ppb_1024_load_export_furious_gpu_preproc,243ms,1371ms,218ms,1,248.89793395996094ms,885ms,None,2.7.0.dev20250201+cu124,329.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_load_export_furious_inductor_cache_dir'},,,221ms,228ms,1024,,248.89793395996094s,253.14255595207214,,375ms,,amg,29331797504.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,28.0
,,,,,,,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_furious_cold,,,,1,,,None,2.7.0.dev20250201+cu124,,"W0201 21:52:42.246000 2706666 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_furious_inductor_cache_dir'},,,,,1024,None,,7.6446356773376465,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,
,,,,,,,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_furious,,,,1,,,None,2.7.0.dev20250201+cu124,,"W0201 21:52:51.055000 2707330 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_furious_inductor_cache_dir'},,,,,1024,None,,9.095084428787231,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,
,,,,,,,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_furious_recompiles,,,,1,,,None,2.7.0.dev20250201+cu124,,"W0201 21:52:59.823000 2708060 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_furious_inductor_cache_dir'},,None,,,1024,None,,8.79776120185852,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,
,,,,,,None,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_furious_gpu_preproc,,,,1,,,None,2.7.0.dev20250201+cu124,,"W0201 21:53:09.828000 2708694 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_furious_inductor_cache_dir'},,,,,1024,None,,10.063116788864136,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,
,,,,,,None,,,0.22.0.dev20250201+cu124,,,amg_ao_ppb_1024_fast_export_furious_gpu_preproc_recompiles,,,,1,,,None,2.7.0.dev20250201+cu124,,"W0201 21:53:18.646000 2709741 site-packages/torch/_logging/_internal.py:1093] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Traceback (most recent call last):
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 666, in <module>
    fire.Fire(main)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/fire/core.py"", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 623, in main
    masks_batch = gen_masks(
                  ^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 322, in gen_masks
    masks = gen_masks_ao(
            ^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/contextlib.py"", line 81, in inner
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/generate_data.py"", line 235, in gen_masks_ao
    masks = mask_generator.generate(image_tensor)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/utils/_contextlib.py"", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 208, in generate
    mask_data = self._generate_masks(image)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 254, in _generate_masks
    crop_data = self._process_crop(image, crop_box, layer_idx, orig_size)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 313, in _process_crop
    return self._process_crop_points(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 331, in _process_crop_points
    batch_data = self._process_batch(
                 ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 672, in _process_batch
    data = self._process_batch_fullgraph(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/automatic_mask_generator.py"", line 540, in _process_batch_fullgraph
    low_res_masks, iou_preds = self.predictor._predict_masks(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py"", line 570, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 1400, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 565, in __call__
    return _compile(
           ^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 997, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_utils_internal.py"", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 726, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 760, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py"", line 1404, in transform_code_object
    transformations(instructions, code_options)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 236, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py"", line 680, in transform
    tracer.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2906, in run
    super().run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2378, in CALL
    self._call(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 2372, in _call
    self.call_function(fn, args, kwargs)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/lazy.py"", line 201, in realize_and_forward
    return getattr(self.realize(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 917, in call_function
    return variables.UserFunctionVariable(fn, source=source).call_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 685, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1765, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 923, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 472, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 323, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py"", line 120, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 929, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3112, in inline_call
    return tracer.inline_call_()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 3249, in inline_call_
    self.run()
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1078, in run
    while self.step():
          ^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 988, in step
    self.dispatch_table[inst.opcode](self, inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1829, in LOAD_ATTR
    self._load_attr(inst)
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py"", line 1819, in _load_attr
    result = BuiltinVariable(getattr).call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1080, in call_function
    return handler(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 917, in builtin_dispatch
    rv = fn(tx, args, kwargs)
         ^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 837, in call_self_handler
    result = self_handler(tx, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builtin.py"", line 1777, in call_getattr
    return obj.var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py"", line 1077, in var_getattr
    return super().var_getattr(tx, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/user_defined.py"", line 1257, in var_getattr
    return VariableTracker.build(tx, subobj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/base.py"", line 454, in build
    return builder.SourcelessBuilder.create(tx, value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/variables/builder.py"", line 3022, in create
    unimplemented(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/_dynamo/exc.py"", line 380, in unimplemented
    raise Unsupported(msg, case_name=case_name)
torch._dynamo.exc.Unsupported: Unexpected type in sourceless builder torch._inductor.package.package.AOTICompiledModel

from user code:
   File ""/home/cpuhrsch/dev/ao/torchao/_models/sam2/sam2_image_predictor.py"", line 487, in _predict_masks
    sparse_embeddings, dense_embeddings = self.model.sam_prompt_encoder(
  File ""/home/cpuhrsch/.conda/envs/nightly20250201py312/lib/python3.12/site-packages/torch/nn/modules/module.py"", line 1760, in _call_impl
    return forward_call(*args, **kwargs)
  File ""/home/cpuhrsch/dev/ao/examples/sam2_amg_server/compile_export_utils.py"", line 326, in forward
    return self.aoti_compiled_model(*args, **kwargs)

Set TORCH_LOGS=""+dynamo"" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

",{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_fast_export_furious_inductor_cache_dir'},,None,,,1024,None,,8.820854902267456,,,,amg,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/amg_ao_fast_furious,
227ms,,,286ms,0,1337.0,,282ms,7.421151381258559img/s,0.22.0.dev20250201+cu124,1.0,596ms,baseline_sps,129ms,596ms,289ms,,134.74997997283936ms,303ms,,2.7.0.dev20250201+cu124,,,None,,,278ms,114ms,1,,134.74997997283936s,138.6910741329193,None,289ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1402492416.0,,1.0
211ms,1.0,,103ms,0,1339.0,,101ms,7.779609437380807img/s,0.22.0.dev20250201+cu124,1.0,577ms,sps_ao,124ms,577ms,105ms,,128.541157245636ms,255ms,,2.7.0.dev20250201+cu124,0.0,,None,,,125ms,109ms,1,,128.541157245636s,132.44918203353882,,222ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1404942848.0,,1.0
220ms,1.0,,215ms,0,1339.0,,101ms,6.681801810316522img/s,0.22.0.dev20250201+cu124,1.0,489ms,sps_ao_ppb_1_basic,145ms,489ms,105ms,1,149.66023063659668ms,229ms,,2.7.0.dev20250201+cu124,0.0,,None,,,103ms,126ms,1,,149.66023063659668s,153.406320810318,,223ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1404989952.0,,1.0
203ms,,,1762ms,0,1343.0,,110ms,2.3164250193404157img/s,0.22.0.dev20250201+cu124,1.0,312516ms,sps_ao_ppb_1_fast_cold,426ms,312516ms,95ms,1,431.6997060775757ms,2073ms,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_inductor_cache_dir'},,,94ms,99ms,1,None,431.6997060775757s,439.5632133483887,,212ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1408784896.0,,1.0
184ms,0.9998690378069878,,654ms,0,1302.0,,94ms,8.268377098652879img/s,0.22.0.dev20250201+cu124,1.0,7856ms,sps_ao_ppb_1_fast,116ms,7856ms,89ms,1,120.94271802902222ms,661ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_inductor_cache_dir'},,,93ms,97ms,1,None,120.94271802902222s,126.1430869102478,,209ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1366200320.0,,1.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,,,1326.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,sps_ao_ppb_1_save_export,,,,1,,,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_inductor_cache_dir'},0,,,,1,,280.1591420173645s,292.04303908348083,,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1390578176.0,,1.0
214ms,0.9998669156432152,,131ms,0,5949.0,,176ms,6.880200257385154img/s,0.22.0.dev20250201+cu124,1.0,742ms,sps_ao_ppb_1_load_export_cold,139ms,742ms,107ms,1,145.3446066379547ms,240ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_inductor_cache_dir'},,,133ms,113ms,1,,145.3446066379547s,150.1962902545929,,218ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6238665728.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
211ms,0.9998669156432152,,114ms,0,5949.0,,98ms,7.7924724494383035img/s,0.22.0.dev20250201+cu124,1.0,680ms,sps_ao_ppb_1_load_export,121ms,680ms,105ms,1,128.32897472381592ms,285ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_inductor_cache_dir'},,,211ms,102ms,1,,128.32897472381592s,133.08489537239075,,219ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6238665728.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
166ms,0.999868567287922,,103ms,0,5971.0,None,98ms,8.393116093730033img/s,0.22.0.dev20250201+cu124,1.0,636ms,sps_ao_ppb_1_load_export_gpu_preproc,113ms,636ms,93ms,1,119.14526009559631ms,178ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_inductor_cache_dir'},,,164ms,104ms,1,,119.14526009559631s,124.24585604667664,,174ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6261886976.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
209ms,0.9998669156432152,,100ms,0,5949.0,,97ms,7.979514035064873img/s,0.22.0.dev20250201+cu124,1.0,613ms,sps_ao_ppb_1_fast_export_cold,119ms,613ms,117ms,1,125.32091498374939ms,225ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_inductor_cache_dir'},,,112ms,102ms,1,None,125.32091498374939s,130.10125064849854,,217ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6238665728.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
204ms,0.9998669156432152,,100ms,0,5949.0,,97ms,8.169289821055504img/s,0.22.0.dev20250201+cu124,1.0,638ms,sps_ao_ppb_1_fast_export,116ms,638ms,93ms,1,122.40966129302979ms,232ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_inductor_cache_dir'},,,97ms,103ms,1,None,122.40966129302979s,127.08338332176208,,218ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6238665728.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
164ms,0.999868567287922,,103ms,0,5971.0,None,97ms,8.432672813730731img/s,0.22.0.dev20250201+cu124,1.0,643ms,sps_ao_ppb_1_fast_export_gpu_preproc,112ms,643ms,94ms,1,118.5863630771637ms,186ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_inductor_cache_dir'},,,98ms,101ms,1,None,118.5863630771637s,122.89277410507202,,171ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,6261886976.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast,6.0
61ms,0.9996557694077491,,1864ms,0,861.0,,23ms,1.6408104447617673img/s,0.22.0.dev20250201+cu124,1.0,570588ms,sps_ao_ppb_1_fast_furious_cold,603ms,570588ms,32ms,1,609.4549210071564ms,2432ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_furious_inductor_cache_dir'},,,25ms,27ms,1,None,609.4549210071564s,620.5061430931091,,71ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,903450624.0,,0.0
60ms,0.9996557694077491,,929ms,0,861.0,,26ms,21.534758596217873img/s,0.22.0.dev20250201+cu124,1.0,8435ms,sps_ao_ppb_1_fast_furious,41ms,8435ms,55ms,1,46.43655490875244ms,936ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_furious_inductor_cache_dir'},,,26ms,28ms,1,None,46.43655490875244s,52.503068923950195,,71ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,903450624.0,,0.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,,,861.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,sps_ao_ppb_1_save_export_furious,,,,1,,,None,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_furious_inductor_cache_dir'},0,,,,1,,384.83890867233276s,394.1347920894623,,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,903450624.0,,0.0
66ms,0.9996665632724762,,23ms,0,1741.0,,23ms,23.43619690479002img/s,0.22.0.dev20250201+cu124,1.0,837ms,sps_ao_ppb_1_load_export_furious_cold,36ms,837ms,18ms,1,42.66903901100159ms,84ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_furious_inductor_cache_dir'},,,24ms,31ms,1,,42.66903901100159s,47.050801515579224,,70ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1826394112.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
64ms,0.9996665632724762,,25ms,0,1741.0,,35ms,25.725397179869134img/s,0.22.0.dev20250201+cu124,1.0,723ms,sps_ao_ppb_1_load_export_furious,34ms,723ms,55ms,1,38.87209177017212ms,79ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_furious_inductor_cache_dir'},,,32ms,29ms,1,,38.87209177017212s,43.2251877784729,,70ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1826394112.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
29ms,0.9996892387866974,,22ms,0,1765.0,None,21ms,35.709611922971966img/s,0.22.0.dev20250201+cu124,1.0,845ms,sps_ao_ppb_1_load_export_furious_gpu_preproc,22ms,845ms,17ms,1,28.00366473197937ms,33ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_load_export_furious_inductor_cache_dir'},,,22ms,20ms,1,,28.00366473197937s,32.56084752082825,,30ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1851366400.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
60ms,0.9996665632724762,,33ms,0,1741.0,,57ms,27.665446806070978img/s,0.22.0.dev20250201+cu124,1.0,705ms,sps_ao_ppb_1_fast_export_furious_cold,31ms,705ms,27ms,1,36.14617204666138ms,75ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_furious_inductor_cache_dir'},,,31ms,28ms,1,None,36.14617204666138s,40.384626626968384,,68ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1826394112.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
62ms,0.9996665632724762,,31ms,0,1741.0,,23ms,26.54388022669438img/s,0.22.0.dev20250201+cu124,1.0,767ms,sps_ao_ppb_1_fast_export_furious,32ms,767ms,57ms,1,37.67346715927124ms,79ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_furious_inductor_cache_dir'},,,39ms,29ms,1,None,37.67346715927124s,41.61856198310852,,68ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1826394112.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
64ms,0.2359429143611593,,24ms,0,1741.0,,25ms,21.63790862226476img/s,0.22.0.dev20250201+cu124,1.0,7868ms,sps_ao_ppb_1_fast_export_furious_recompiles,41ms,7868ms,18ms,1,46.215187311172485ms,82ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_furious_inductor_cache_dir'},,None,42ms,29ms,1,None,46.215187311172485s,51.43656826019287,,69ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1826394112.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
27ms,0.9996892387866974,,20ms,0,1765.0,None,21ms,38.624909946204575img/s,0.22.0.dev20250201+cu124,1.0,615ms,sps_ao_ppb_1_fast_export_furious_gpu_preproc,21ms,615ms,17ms,1,25.89002799987793ms,30ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_furious_inductor_cache_dir'},,,21ms,20ms,1,None,25.89002799987793s,29.959320545196533,,29ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1851366400.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
28ms,0.20694049453025515,,21ms,0,1765.0,None,21ms,35.162125386193665img/s,0.22.0.dev20250201+cu124,1.0,2354ms,sps_ao_ppb_1_fast_export_furious_gpu_preproc_recompiles,23ms,2354ms,17ms,1,28.4396915435791ms,34ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/sps_fast_export_furious_inductor_cache_dir'},,None,22ms,20ms,1,None,28.4396915435791s,34.0217080116272,,29ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,sps,1851366400.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/sps_ao_fast_furious,1.0
753ms,,,580ms,211,1337.0,,410ms,3.084989915671631img/s,0.22.0.dev20250201+cu124,1.0,652ms,baseline_mps,317ms,1501ms,169ms,,324.1501681804657ms,1462ms,,2.7.0.dev20250201+cu124,,,None,,,498ms,249ms,,,324.1501681804657s,328.2415919303894,None,1016ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,1402492416.0,,1.0
220ms,0.999999164044857,,161ms,0,8022.0,,118ms,7.132574485927408img/s,0.22.0.dev20250201+cu124,1.0,620ms,mps_ao,134ms,620ms,128ms,,140.20183062553406ms,271ms,,2.7.0.dev20250201+cu124,0.0,,None,,,127ms,120ms,,,140.20183062553406s,144.2054636478424,,234ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,8411699712.0,,8.0
233ms,0.999999164044857,,152ms,0,8022.0,,139ms,6.170666895538562img/s,0.22.0.dev20250201+cu124,1.0,572ms,mps_ao_ppb_None_basic,155ms,572ms,147ms,1,162.05703806877136ms,299ms,,2.7.0.dev20250201+cu124,0.0,,None,,,223ms,137ms,,,162.05703806877136s,166.28092455863953,,259ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,8411699712.0,,8.0
211ms,,,1008ms,0,8021.0,,106ms,2.0301487208923032img/s,0.22.0.dev20250201+cu124,1.0,289497ms,mps_ao_ppb_None_fast_cold,485ms,289497ms,93ms,1,492.57475066185ms,56739ms,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_inductor_cache_dir'},,,111ms,105ms,,None,492.57475066185s,501.8415961265564,,228ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,8411176448.0,,8.0
217ms,0.9983840299248695,,447ms,0,8021.0,,106ms,6.521323362151368img/s,0.22.0.dev20250201+cu124,1.0,8370ms,mps_ao_ppb_None_fast,147ms,8370ms,94ms,1,153.34310913085938ms,1399ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_inductor_cache_dir'},,,109ms,116ms,,None,153.34310913085938s,158.5558533668518,,236ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,8411176448.0,,8.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,,,1326.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,mps_ao_ppb_None_save_export,,,,1,,,,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_inductor_cache_dir'},0,,,,,,212.2082929611206s,220.4392592906952,,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,1390578176.0,,1.0
213ms,0.9983840027451515,,126ms,0,7206.0,,110ms,7.527675492386197img/s,0.22.0.dev20250201+cu124,1.0,526ms,mps_ao_ppb_None_load_export_cold,126ms,526ms,98ms,1,132.84313344955444ms,279ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_inductor_cache_dir'},,,119ms,112ms,,,132.84313344955444s,137.11322283744812,,240ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7556661248.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
209ms,0.9983840027451515,,113ms,0,7206.0,,110ms,7.686039010546061img/s,0.22.0.dev20250201+cu124,1.0,520ms,mps_ao_ppb_None_load_export,123ms,520ms,103ms,1,130.10602712631226ms,258ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_inductor_cache_dir'},,,119ms,110ms,,,130.10602712631226s,134.4711091518402,,230ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7556661248.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
182ms,0.9984545547366143,,114ms,0,7230.0,None,111ms,7.353002586267136img/s,0.22.0.dev20250201+cu124,1.0,489ms,mps_ao_ppb_None_load_export_gpu_preproc,129ms,489ms,144ms,1,135.99886417388916ms,216ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_inductor_cache_dir'},,,186ms,117ms,,,135.99886417388916s,140.2737500667572,,203ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7581827072.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
214ms,0.9983836042881012,,223ms,108,7206.0,,220ms,3.8507757521879333img/s,0.22.0.dev20250201+cu124,1.0,48028ms,mps_ao_ppb_None_fast_export_cold,248ms,55396ms,205ms,1,259.68793416023254ms,48035ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_inductor_cache_dir'},,,235ms,109ms,,None,259.68793416023254s,266.26405930519104,,227ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7556661248.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
213ms,0.9983836028575898,,218ms,0,7206.0,,210ms,7.363453976309458img/s,0.22.0.dev20250201+cu124,1.0,3281ms,mps_ao_ppb_None_fast_export,128ms,3281ms,218ms,1,135.805832862854ms,1543ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_inductor_cache_dir'},,,116ms,109ms,,None,135.805832862854s,140.8684446811676,,229ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7556661248.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
170ms,0.9984543620347976,,114ms,0,7230.0,None,120ms,7.69515399574898img/s,0.22.0.dev20250201+cu124,1.0,3804ms,mps_ao_ppb_None_fast_export_gpu_preproc,123ms,3804ms,94ms,1,129.95191526412964ms,1544ms,,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_inductor_cache_dir'},,,121ms,108ms,,None,129.95191526412964s,135.3585295677185,,194ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,7581827072.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast,7.0
67ms,0.9963072105944156,,978ms,0,4222.0,,63ms,1.4298750535133458img/s,0.22.0.dev20250201+cu124,1.0,557148ms,mps_ao_ppb_None_fast_furious_cold,692ms,557148ms,37ms,1,699.3618061542511ms,72220ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_furious_inductor_cache_dir'},,,63ms,32ms,,None,699.3618061542511s,708.8026599884033,,78ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,4427842560.0,,4.0
67ms,0.996307507365942,,377ms,0,4222.0,,68ms,19.676675141504166img/s,0.22.0.dev20250201+cu124,1.0,8369ms,mps_ao_ppb_None_fast_furious,44ms,8369ms,56ms,1,50.82159423828125ms,1393ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_furious_inductor_cache_dir'},,,69ms,30ms,,None,50.82159423828125s,56.04477787017822,,77ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,4427842560.0,,4.0
,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,,,861.0,,,0.0img/s,0.22.0.dev20250201+cu124,1.0,,mps_ao_ppb_None_save_export_furious,,,,1,,,None,2.7.0.dev20250201+cu124,,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_furious_inductor_cache_dir'},0,,,,,,344.0288770198822s,355.26348423957825,,,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,903450624.0,,0.0
87ms,0.9959431630969048,,78ms,0,3813.0,,76ms,15.037818861159955img/s,0.22.0.dev20250201+cu124,1.0,786ms,mps_ao_ppb_None_load_export_furious_cold,56ms,786ms,69ms,1,66.49900555610657ms,230ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_furious_inductor_cache_dir'},,,81ms,50ms,,,66.49900555610657s,71.31466555595398,,95ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,3998911488.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
82ms,0.9959431630969048,,72ms,0,3813.0,,56ms,16.97277646622607img/s,0.22.0.dev20250201+cu124,1.0,770ms,mps_ao_ppb_None_load_export_furious,52ms,770ms,64ms,1,58.917879581451416ms,319ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_furious_inductor_cache_dir'},,,53ms,46ms,,,58.917879581451416s,63.18819451332092,,94ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,3998911488.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
46ms,0.9959993916153908,,39ms,0,3837.0,None,36ms,23.048828007806954img/s,0.22.0.dev20250201+cu124,1.0,887ms,mps_ao_ppb_None_load_export_furious_gpu_preproc,36ms,887ms,30ms,1,43.38615393638611ms,300ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_load_export_furious_inductor_cache_dir'},,,38ms,33ms,,,43.38615393638611s,48.07710337638855,,55ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,4024077312.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
79ms,0.9967940300703049,,46ms,0,3813.0,,46ms,5.15555993340758img/s,0.22.0.dev20250201+cu124,1.0,54821ms,mps_ao_ppb_None_fast_export_furious_cold,185ms,54821ms,66ms,1,193.9653525352478ms,50618ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_furious_inductor_cache_dir'},,,71ms,61ms,,None,193.9653525352478s,200.98076367378235,,88ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,3998911488.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
77ms,0.9967941699624061,,66ms,0,3813.0,,67ms,13.941360247679265img/s,0.22.0.dev20250201+cu124,1.0,3962ms,mps_ao_ppb_None_fast_export_furious,64ms,3962ms,59ms,1,71.72901225090027ms,1769ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_furious_inductor_cache_dir'},,,70ms,60ms,,None,71.72901225090027s,77.7831768989563,,86ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,3998911488.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
72ms,0.995794223189354,,61ms,0,3813.0,,51ms,14.00474946970205img/s,0.22.0.dev20250201+cu124,1.0,13611ms,mps_ao_ppb_None_fast_export_furious_recompiles,62ms,13611ms,30ms,1,71.40434765815735ms,7619ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_furious_inductor_cache_dir'},,None,69ms,36ms,,None,71.40434765815735s,76.893630027771,,81ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,3998911488.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
37ms,0.9958736309111118,,26ms,0,3837.0,None,26ms,26.79993348935421img/s,0.22.0.dev20250201+cu124,1.0,3798ms,mps_ao_ppb_None_fast_export_furious_gpu_preproc,30ms,3798ms,19ms,1,37.313525438308716ms,1762ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_furious_inductor_cache_dir'},,,30ms,23ms,,None,37.313525438308716s,43.1899528503418,,46ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,4024077312.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
36ms,0.9948736628592014,,26ms,0,3837.0,None,25ms,25.771414986721894img/s,0.22.0.dev20250201+cu124,1.0,5199ms,mps_ao_ppb_None_fast_export_furious_gpu_preproc_recompiles,31ms,5199ms,19ms,1,38.80268120765686ms,1556ms,None,2.7.0.dev20250201+cu124,0.0,,{'TORCHINDUCTOR_CACHE_DIR': '/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/mps_fast_export_furious_inductor_cache_dir'},,None,29ms,23ms,,None,38.80268120765686s,44.24243474006653,,43ms,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/amg_baseline_annotations,mps,4024077312.0,/home/cpuhrsch/blogs/tmp/sam2_amg_example_run_18/exported_models/mps_ao_fast_furious,3.0
